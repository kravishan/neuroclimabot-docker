# =============================================================================
# Application Settings
# =============================================================================
DEBUG=true
LOG_LEVEL=INFO
LOG_FORMAT=json
ENVIRONMENT=development

# Server Configuration
HOST=0.0.0.0
PORT=8000
WORKERS=1
RELOAD=false

# =============================================================================
# Authentication Settings
# =============================================================================
# Set to false to disable authentication (app will work without auth)
# Set to true to require authentication for all endpoints
AUTH_ENABLED=false
AUTH_TOKEN_EXPIRY_DAYS=7
AUTH_DATABASE_URL=sqlite:///./auth_tokens.db

# =============================================================================
# Email Configuration (Maileroo Primary, SMTP Fallback)
# =============================================================================
# Email Provider: "maileroo" or "smtp"
EMAIL_PROVIDER=maileroo

# Maileroo Settings (Primary Provider)
MAILEROO_API_KEY=your_maileroo_api_key_here
MAILEROO_FROM_EMAIL=your_maileroo_api_key_here
MAILEROO_FROM_NAME=NeuroClima Bot
MAILEROO_API_URL=https://smtp.maileroo.com/api/v2/emails

# SMTP Settings (Fallback Provider)
SMTP_SERVER=localhost
SMTP_PORT=587
SMTP_USERNAME=
SMTP_PASSWORD=
FROM_EMAIL=noreply@neuroclimabot.com

# Email Retry Configuration
EMAIL_TIMEOUT_SECONDS=30
EMAIL_RETRY_ATTEMPTS=3
EMAIL_RETRY_DELAY_SECONDS=1.0

# =============================================================================
# Admin Dashboard Configuration
# =============================================================================

ADMIN_USERNAME=your_admin_username_here
ADMIN_PASSWORD=your_admin_password_here

# =============================================================================
# MinIO Configuration
# =============================================================================
MINIO_ENDPOINT=your_minio_server_endpoint_here
MINIO_ACCESS_KEY=your_minio_access_key_here
MINIO_SECRET_KEY=your_minio_secret_key_here
MINIO_SECURE=true
MINIO_REGION=us-east-1
MINIO_TIMEOUT=10

# MinIO Bucket Configuration
MINIO_BUCKET_NEWS=news
MINIO_BUCKET_POLICY=policies
MINIO_BUCKET_RESEARCH_PAPERS=researchpapers
MINIO_BUCKET_SCIENTIFIC_DATA=scientificdata
MINIO_BUCKET_REPORTS=reports
MINIO_DEFAULT_BUCKET=researchpapers

# MinIO Shareable URL Settings
MINIO_PRESIGNED_URL_EXPIRY_MINUTES=30
MINIO_SHAREABLE_URL_EXPIRY_MINUTES=30
MINIO_ENABLE_PUBLIC_SHARING=true
MINIO_URL_TYPE=shareable

# MinIO Performance Settings
MINIO_MAX_CONCURRENT_OPERATIONS=8
MINIO_PATH_CACHE_DURATION_HOURS=1
MINIO_ENABLE_PATH_CACHING=true

# =============================================================================
# Milvus Configuration
# =============================================================================
MILVUS_HOST=your_milvus_server_host_here
MILVUS_PORT=19530
MILVUS_USER=your_milvus_username_here
MILVUS_PASSWORD=your_milvus_password_here

# Milvus Retrieval Limits
CHUNKS_RETRIEVAL_LIMIT=20
SUMMARIES_RETRIEVAL_LIMIT=12
SIMILARITY_THRESHOLD=0.1

# =============================================================================
# Redis Configuration
# =============================================================================
# For local development (Windows/Mac/Linux), use localhost
REDIS_URL=redis://localhost:6379/0
# If using password authentication:
# REDIS_URL=redis://:YourPassword@localhost:6379/0
REDIS_PASSWORD=your_redis_password_here

# =============================================================================
# Embedding Model Configuration
# =============================================================================
# OpenAI-compatible embedding API endpoint
EMBEDDING_API_URL=https://lex.itml.space/v1/embeddings
EMBEDDING_MODEL=nomic-embed-text
EMBEDDING_DIMENSION=768
EMBEDDING_TIMEOUT=30

# =============================================================================
# LLM Configuration
# =============================================================================
# Default LLM Provider: "openai_compatible", "ollama", or "openai"
DEFAULT_LLM_PROVIDER=openai_compatible

# OpenAI-Compatible API Configuration (Primary LLM)
# Works with any OpenAI-compatible endpoint (e.g., vLLM, LocalAI, etc.)
LLM_API_URL=https://lex.itml.space/v1/chat/completions
LLM_API_TOKEN=your_api_token_here
LLM_MODEL=mistral.mistral-7b-instruct-v0:2
LLM_TEMPERATURE=0.2
LLM_MAX_TOKENS=1500
LLM_TIMEOUT=60

# Ollama Configuration (Alternative LLM)
OLLAMA_BASE_URL=your_ollama_server_url_here
#OLLAMA_BASE_URL=http://localhost:11434
OLLAMA_MODEL=mistral:7b
OLLAMA_TEMPERATURE=0.2
OLLAMA_MAX_TOKENS=1500
OLLAMA_TIMEOUT=30
OLLAMA_CONNECTION_POOL_SIZE=5

# OpenAI Configuration (Optional - for OpenAI API directly)
OPENAI_API_KEY=
OPENAI_MODEL=gpt-4o
OPENAI_TEMPERATURE=0.2
OPENAI_MAX_TOKENS=1500
OPENAI_TIMEOUT=15

# =============================================================================
# Langfuse Configuration (Tracing & Observability)
# =============================================================================

LANGFUSE_ENABLED=true
LANGFUSE_SECRET_KEY=your_langfuse_secret_key_here
LANGFUSE_PUBLIC_KEY=your_langfuse_public_key_here
LANGFUSE_HOST=your_langfuse_server_url_here

# Langfuse Settings
LANGFUSE_DEBUG=false
LANGFUSE_FLUSH_AT=15
LANGFUSE_FLUSH_INTERVAL=10
LANGFUSE_SAMPLE_RATE=1.0
LANGFUSE_ENABLE_GENERATIONS=true
LANGFUSE_ENABLE_SCORES=true
LANGFUSE_MAX_RETRIES=3
LANGFUSE_TIMEOUT=20

# Langfuse Feature Flags
LANGFUSE_TRACE_RAG_PIPELINE=true
LANGFUSE_TRACE_LLM_CALLS=true
LANGFUSE_TRACE_RETRIEVAL=true
LANGFUSE_TRACE_RERANKING=true
LANGFUSE_TRACE_API_CALLS=true
LANGFUSE_TRACE_SESSIONS=true

# Langfuse Metadata
LANGFUSE_RELEASE=
LANGFUSE_USER_ID=neuroclima-system
LANGFUSE_SESSION_ID_PREFIX=nc

# =============================================================================
# GraphRAG Service Configuration
# =============================================================================
GRAPHRAG_SERVER_URL=http://localhost:5000
GRAPHRAG_API_TIMEOUT=30.0

# GraphRAG API Performance
GRAPHRAG_API_MAX_RETRIES=3
GRAPHRAG_API_RETRY_DELAY=1.0
GRAPHRAG_API_CONNECTION_TIMEOUT=10.0
GRAPHRAG_API_READ_TIMEOUT=25.0

# GraphRAG Local Search Configuration
GRAPHRAG_LOCAL_SEARCH_MAX_ENTITIES=20
GRAPHRAG_LOCAL_SEARCH_MAX_RELATIONSHIPS=30
GRAPHRAG_LOCAL_SEARCH_MAX_COMMUNITIES=10
GRAPHRAG_LOCAL_SEARCH_CONTEXT_DEPTH=1
GRAPHRAG_LOCAL_SEARCH_MIN_RELEVANCE_SCORE=0.1
GRAPHRAG_LOCAL_SEARCH_INCLUDE_COMMUNITY_CONTEXT=true
GRAPHRAG_LOCAL_SEARCH_USE_LLM_EXTRACTION=true

# GraphRAG Visualization Configuration
GRAPHRAG_VISUALIZATION_MAX_NODES=200
GRAPHRAG_VISUALIZATION_MAX_EDGES=400
GRAPHRAG_VISUALIZATION_INCLUDE_SUMMARY=true

# GraphRAG Feature Flags
GRAPHRAG_API_ENABLE_COMMUNITIES=true
GRAPHRAG_API_ENABLE_RELATIONSHIPS=true
GRAPHRAG_API_DEFAULT_SEARCH_TYPE=local

# GraphRAG Relevance Scoring
GRAPH_MIN_RELEVANCE_SCORE=0.1
GRAPH_RETRIEVAL_LIMIT=15

# GraphRAG Bucket Configuration
GRAPHRAG_ENABLE_BUCKET_FILTERING=true
GRAPHRAG_DEFAULT_BUCKET=researchpapers
GRAPHRAG_AVAILABLE_BUCKETS=researchpapers,news,policies

# =============================================================================
# Translation Service Configuration
# =============================================================================
TRANSLATION_SERVICE_URL=http://localhost:5000
TRANSLATION_SERVICE_TIMEOUT=60.0
TRANSLATION_SUPPORTED_LANGUAGES=en,it,pt,el

# =============================================================================
# Social Tipping Point (STP) Service Configuration
# =============================================================================
STP_SERVICE_ENABLED=true
STP_SERVICE_URL=http://localhost:5000
STP_SERVICE_ENDPOINT=/stp/search
STP_SERVICE_TIMEOUT=30.0

# STP Thresholds
STP_CONFIDENCE_THRESHOLD=0.1
STP_SIMILARITY_THRESHOLD=0.3
STP_TOP_K=1
STP_INCLUDE_METADATA=true

# STP Feature Flags
STP_PARALLEL_PROCESSING=true
STP_FALLBACK_MESSAGE=No specific social tipping point available for this query.

# STP Performance
STP_MAX_RETRIES=2
STP_RETRY_DELAY=1.0
STP_CACHE_ENABLED=false

# =============================================================================
# RAG Configuration
# =============================================================================
# Retrieval Settings
MAX_RETRIEVED_DOCS=15
INITIAL_RETRIEVAL_LIMIT=25
RETRIEVAL_MILVUS_TIMEOUT=15.0
RETRIEVAL_GRAPHRAG_API_TIMEOUT=15.0
RETRIEVAL_TOTAL_TIMEOUT=25.0

# Reranking Configuration
RERANKING_ENABLED=true
RERANKER_ENABLED=true
RERANKER_MODEL=cross-encoder/ms-marco-MiniLM-L-6-v2
RERANKING_MODEL=cross-encoder/ms-marco-MiniLM-L-6-v2
RERANKING_FACTOR=2
RERANKING_TIMEOUT=5
RERANKER_BATCH_SIZE=16
RERANKER_MAX_LENGTH=400
RERANKER_MIN_SCORE=0.75
TOP_K_RERANK=15

# Ultra-Fast Reranker Settings
ULTRA_FAST_RERANKER_ENABLED=true
RERANKER_WORD_OVERLAP_WEIGHT=0.2
RERANKER_PHRASE_MATCH_WEIGHT=0.1
RERANKER_SOURCE_BOOST_WEIGHT=0.03

# Response Generation
MAX_RESPONSE_LENGTH=4000
INCLUDE_SOURCES=true
MAX_SOURCES=4
MAX_REFERENCES=8
RESPONSE_LANGUAGE=en
SUPPORTED_LANGUAGES=en,it,pt,el

# Context Configuration
MAX_CONTEXT_CHUNKS=8
MAX_CONTEXT_SUMMARIES=4
MAX_CONTEXT_GRAPH_ITEMS=6
MAX_CONTEXT_LENGTH=8000

# =============================================================================
# Caching Configuration
# =============================================================================
ENABLE_RESPONSE_CACHING=true
ENABLE_RESULT_CACHING=true
ENABLE_EMBEDDING_CACHING=true
CACHE_TTL_SECONDS=300
EMBEDDING_CACHE_SIZE=1000
QUERY_CACHE_SIZE=500
ENABLE_BUCKET_AWARE_CACHING=true

# =============================================================================
# Memory and Session Configuration
# =============================================================================
MEMORY_WINDOW_SIZE=6
MAX_CONVERSATION_HISTORY=30

# Session timeout and warning settings (configurable from .env)
# SESSION_TIMEOUT_MINUTES: Total session timeout duration
# SESSION_WARNING_MINUTES: Show warning when remaining time â‰¤ this value
# Example: 10 min timeout, 1 min warning = warning appears in the last minute
REDIS_SESSION_TIMEOUT_MINUTES=10
REDIS_SESSION_WARNING_MINUTES=1

# Conversation Summary Settings
ENABLE_CONVERSATION_SUMMARY=true
SUMMARY_MESSAGE_THRESHOLD=10
SUMMARY_MIN_MESSAGES=8
SUMMARY_MAX_LENGTH=500
SUMMARY_TIMEOUT=15

# =============================================================================
# Feature Flags
# =============================================================================
# Core Features
ENABLE_CHAT=true
ENABLE_DOCUMENT_UPLOAD=true
ENABLE_ADMIN_API=true
ENABLE_CONVERSATION_MEMORY=true

# Performance Features
ENABLE_PARALLEL_RETRIEVAL=true
ENABLE_EARLY_STOPPING=true

# Advanced Features
ENABLE_MULTILINGUAL=true
ENABLE_VOICE_INPUT=false
ENABLE_ANALYTICS=true
ENABLE_FEEDBACK=true

# Integration Features
ENABLE_GRAPH_INTEGRATION=true
ENABLE_GRAPHRAG_API=true
ENABLE_RERANKING=true
ENABLE_BUCKET_FILTERING=false
ENABLE_BUCKET_AWARE_RESPONSES=true

# Experimental Features (Disabled for speed)
ENABLE_QUERY_EXPANSION=false
ENABLE_AUTO_SUMMARIZATION=false

# =============================================================================
# Rate Limiting
# =============================================================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW=60
CHAT_RATE_LIMIT=20
UPLOAD_RATE_LIMIT=5
ADMIN_RATE_LIMIT=50

# =============================================================================
# Performance & Monitoring
# =============================================================================
# Performance Settings
TARGET_RESPONSE_TIME_SECONDS=20.0
MAX_RESPONSE_TIME_SECONDS=45.0
MAX_CONCURRENT_REQUESTS=10
REQUEST_TIMEOUT_SECONDS=30
HTTP_CONNECTION_POOL_SIZE=20
HTTP_CONNECTION_TIMEOUT=5
HTTP_READ_TIMEOUT=10

# Timeouts
EMBEDDING_GENERATION_TIMEOUT=10.0
EMBEDDING_TIMEOUT=10.0
EXTERNAL_SERVICE_CONNECT_TIMEOUT=2.0
EXTERNAL_SERVICE_READ_TIMEOUT=5.0

# Logging Configuration
LOG_FILE=
LOG_ROTATION=1 day
LOG_RETENTION=30 days

# =============================================================================
# CORS Settings
# =============================================================================
ALLOWED_ORIGINS=*
ALLOW_CREDENTIALS=false
ALLOWED_METHODS=*
ALLOWED_HEADERS=*

# =============================================================================
# Security Settings
# =============================================================================
SECRET_KEY=
ACCESS_TOKEN_EXPIRE_MINUTES=30
ALGORITHM=HS256
